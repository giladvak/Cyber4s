This is as far as i got by now. Some problems appeared in the last moment after i managed moving the pieces with the cell marking but ill figure it out today.
